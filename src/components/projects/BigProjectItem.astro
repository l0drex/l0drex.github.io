---
import { dateFormatter } from "@utils/general";
import type { CollectionEntry } from "astro:content";
import LanguageTag from "./LanguageTag.astro";
import Image from "astro/components/Image.astro";

interface Props {
  project: CollectionEntry<"projects">["data"];
  href: string;
}

const { project, href } = Astro.props;

const color: string = project.color ?? "white";
const colorDark: string = project.colorDark ?? "oklch(37.3% 0.034 259.733)";

const lang = project.languages?.at(0) ?? "";
---

<li
  class="bg-(--color) dark:bg-(--colorDark) rounded-2xl w-80 h-48 shrink-0 shadow-lg select-none flex relative overflow-hidden"
>
  {
    project.image && (
      <div class="absolute inset-0 z-0">
        <Image
          src={project.image}
          alt={project.title}
          width={640}
          height={384}
          class="w-full h-full object-cover"
        />
      </div>
    )
  }

  <a
    href={href}
    class:list={[
      "flex flex-col justify-between size-full relative p-4 opacity-100 bg-(--color)/60 dark:bg-(--colorDark)/70 backdrop-blur-sm",
      project.image ? "hover:opacity-50  transition-opacity duration-250" : "",
    ]}
  >
    <h2 class="text-2xl font-black mb-1">{project.title}</h2>
    <p class="grow">
      {project.description}
    </p>
    <div class="flex justify-between text-gray-500 dark:text-gray-100">
      <LanguageTag lang={lang} />
      <div class="m-0">{dateFormatter(project.date, true)}</div>
    </div>
  </a>
</li>

<style define:vars={{ color, colorDark }}></style>
