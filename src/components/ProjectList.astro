---
import { getCollection, type CollectionEntry } from "astro:content";
import Project from "@components/ProjectItem.astro";
import { ProjectType } from "@utils/projects";

interface Props {
  limit?: number;
  type: ProjectType
}

const {limit, type} = Astro.props;

const collection: CollectionEntry<"projects">[] = await getCollection('projects');
let projects = collection
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .filter(p => p.data.type === type);

if (limit != null) {
  projects = projects.filter((r, i) => i < limit);
}
---

<ul>
  {projects.sort((pa, pb) => pb.data.date.valueOf() - pa.data.date.valueOf())
    .map(p => <Project project={p.data} href={'/projects/' + p.slug} />
  )}
</ul>

<style>
    ul {
        display: flex;
        gap: 1rem;
        padding: 1rem;
        margin: 0;
        justify-content: space-between;

        overflow-x: auto;
        max-width: calc(100vw - 3rem);
    }

    @media (min-width: 768px) {
        ul {
            display: grid;
            grid: auto-flow dense / 1fr 1fr 1fr;
            justify-items: center;
        }
    }
</style>
