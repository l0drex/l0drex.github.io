---
import { getCollection, type CollectionEntry } from "astro:content";
import MarkdownPostLayout from "@layouts/BlogPost.astro";
import Layout from "@layouts/ContentLayout.astro";
import Button from "@components/Button.astro";

export async function getStaticPaths() {
  const posts: CollectionEntry<"blog">[] = await getCollection("blog");

  return posts.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

interface Props {
  entry: CollectionEntry<"blog">;
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const projectUrl: string = entry.data.project?.id ?? "";
---

<Layout title={entry.data.title}>
  <MarkdownPostLayout frontmatter={entry.data}>
    <Content />
    <div slot="references" id="links" class="my-8 text-center">
      {
        entry.data.project && (
          <Button
            href={projectUrl}
            icon="mdi:package"
            label="Related project"
          />
        )
      }
    </div>
  </MarkdownPostLayout>
</Layout>
